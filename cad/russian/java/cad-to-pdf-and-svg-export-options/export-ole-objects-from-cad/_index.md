---
date: 2026-01-04
description: Узнайте, как **сохранять CAD в PNG** и без труда экспортировать OLE‑объекты
  из файлов CAD с помощью Aspose.CAD для Java. Быстрая настройка, полный пример кода
  и рекомендации по лучшим практикам.
linktitle: Export OLE Objects from CAD
second_title: Aspose.CAD Java API
title: Сохранение CAD в PNG и экспорт OLE‑объектов с помощью Aspose.CAD для Java
url: /ru/java/cad-to-pdf-and-svg-export-options/export-ole-objects-from-cad/
weight: 10
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Сохранить CAD в PNG и экспортировать OLE‑объекты с Aspose.CAD для Java

## Введение

В быстро меняющемся мире систем автоматизированного проектирования (CAD) возможность **сохранить CAD в PNG** и одновременно извлекать встроенные OLE‑объекты (Object Linking and Embedding) может существенно ускорить ваш рабочий процесс. Независимо от того, создаёте ли вы инструмент пакетного преобразования, генерируете миниатюры для веб‑портала или просто архивируете OLE‑контент, Aspose.CAD для Java предоставляет чистый программный способ сделать это. В этом руководстве мы пройдём весь процесс от настройки проекта до экспорта каждого OLE‑объекта в виде PNG‑изображения.

## Быстрые ответы
- **Можно ли экспортировать OLE‑объекты напрямую в PNG?** Да — Aspose.CAD загружает CAD‑файл и позволяет растеризовать каждый макет в PNG.  
- **Какая версия Java требуется?** Java 8 или новее.  
- **Нужна ли лицензия для этой функции?** Бесплатная пробная версия подходит для оценки; для продакшн‑использования требуется лицензия.  
- **Сохраняются ли векторные данные?** Растеризация в PNG сохраняет визуальное качество, но результат является растровым, а не векторным.  
- **Поддерживается ли пакетная обработка?** Абсолютно — перебирайте массив файлов, как показано в примере кода.

## Предварительные требования

Прежде чем начать, убедитесь, что у вас есть следующее:

- **Java Development Kit (JDK)** — установлен Java 8+ и настроен.  
- **Aspose.CAD for Java** — скачайте последнюю библиотеку по [download link](https://releases.aspose.com/cad/java/).  
- **Исходные CAD‑файлы** — любые файлы DWG/DXF/DGN, содержащие OLE‑объекты, которые вы хотите экспортировать.

## Импорт пространств имён

Для работы с CAD‑файлами необходимо импортировать основные классы Aspose.CAD. Сохраните блок импорта точно как показано — он содержит классы, используемые далее в руководстве.

```java
import com.aspose.cad.Image;

import com.aspose.cad.fileformats.cad.CadImage;
import com.aspose.cad.imageoptions.CadRasterizationOptions;
import com.aspose.cad.imageoptions.PngOptions;
```

## Как сохранить CAD в PNG

Ниже представлено лаконичное пошаговое руководство, показывающее **как экспортировать OLE‑объекты и сохранить CAD в PNG**. Каждый шаг включает краткое пояснение и точный код, который нужно скопировать в ваш проект.

### Шаг 1: Установите каталог документов

Определите папку, в которой находятся ваши CAD‑чертежи. Замените заполнитель реальным путём на вашем компьютере.

```java
String dataDir = "Your Document Directory" + "DWGDrawings/";
```

### Шаг 2: Задайте имена CAD‑файлов

Перечислите все CAD‑файлы, которые необходимо обработать. Можно добавить столько записей, сколько потребуется.

```java
String[] files = new String[] { "D ZD junior D10m H2m.dwg", "ZD - Senior D6m H2m45.dwg" };
```

### Шаг 3: Настройте параметры экспорта PNG

Сконфигурируйте параметры растеризации. Здесь мы выбираем конкретный макет (`Layout1`) и используем параметры PNG по умолчанию.

```java
PngOptions pngOptions = new PngOptions();
CadRasterizationOptions rasterizationOptions = new CadRasterizationOptions();
pngOptions.setVectorRasterizationOptions(rasterizationOptions);
rasterizationOptions.setLayouts(new String[] { "Layout1" });
```

### Шаг 4: Переберите CAD‑файлы и сохраните их в PNG

Загрузите каждый CAD‑файл, растеризуйте OLE‑объекты и запишите полученный PNG‑файл. Суффикс `_out.png` помогает идентифицировать сгенерированные изображения.

```java
for(String file : files)
{
    CadImage cadImage = (CadImage)Image.load(dataDir + file);
    cadImage.save(dataDir + file + "_out.png", pngOptions);
}
```

## Распространённые проблемы и решения

| Проблема | Почему происходит | Решение |
|---------|-------------------|---------|
| **`Image.load` бросает `FileNotFoundException`** | Неправильный путь `dataDir` или опечатка в имени файла. | Проверьте строку каталога и убедитесь, что имена файлов точно совпадают, включая пробелы. |
| **Полученный PNG пустой** | Указанное имя макета отсутствует в исходном CAD‑файле. | Вызовите `cadImage.getLayouts()` для получения списка доступных макетов, затем обновите `rasterizationOptions.setLayouts(...)`. |
| **Большие CAD‑файлы вызывают OutOfMemoryError** | Растеризация изображений высокого разрешения потребляет много памяти кучи. | Увеличьте размер кучи JVM (`-Xmx2g`) или уменьшите разрешение растеризации через `rasterizationOptions.setResolution(...)`. |

## Часто задаваемые вопросы

### Q1: Совместим ли Aspose.CAD со всеми форматами CAD‑файлов?

A1: Aspose.CAD поддерживает различные форматы CAD, включая DWG, DXF и DGN. Полный список см. в [documentation](https://reference.aspose.com/cad/java/).

### Q2: Можно ли настроить параметры экспорта для OLE‑объектов?

A2: Да, Aspose.CAD предоставляет обширные возможности настройки параметров экспорта, позволяя адаптировать результат под ваши конкретные требования.

### Q3: Есть ли бесплатная пробная версия Aspose.CAD?

A3: Да, вы можете оценить возможности Aspose.CAD, получив бесплатную пробную версию [here](https://releases.aspose.com/).

### Q4: Где можно получить поддержку сообщества по Aspose.CAD?

A4: Присоединяйтесь к сообществу Aspose.CAD на [forum](https://forum.aspose.com/c/cad/19), чтобы задать вопросы и поделиться опытом.

### Q5: Как приобрести лицензию на Aspose.CAD?

A5: Посетите страницу [purchase page](https://purchase.aspose.com/buy) для выбора лицензии, соответствующей вашим потребностям разработки.

## Заключение

Следуя этим пяти простым шагам, вы сможете **сохранить CAD в PNG** и извлечь каждый встроенный OLE‑объект всего несколькими строками кода на Java. Такой подход идеален для пакетных конвертаций, автоматизированных отчётов или любых сценариев, где требуются растровые изображения CAD‑контента без ручного экспорта. Не стесняйтесь экспериментировать с различными параметрами растеризации, чтобы подобрать оптимальное соотношение качества и производительности.

---

**Последнее обновление:** 2026-01-04  
**Тестировано с:** Aspose.CAD for Java 24.12 (самая свежая на момент написания)  
**Автор:** Aspose  

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}