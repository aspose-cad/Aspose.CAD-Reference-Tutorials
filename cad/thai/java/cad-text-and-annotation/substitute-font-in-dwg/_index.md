---
date: 2025-12-28
description: เรียนรู้วิธีโหลดไฟล์ DWG ในโครงการ Java และตั้งค่าชื่อฟอนต์หลักโดยใช้
  Aspose.CAD สำหรับ Java คู่มือขั้นตอนต่อขั้นตอนเพื่อภาพ CAD ที่สมบูรณ์แบบ
linktitle: Substitute Font in DWG
second_title: Aspose.CAD Java API
title: วิธีโหลดไฟล์ DWG ใน Java และแทนที่ฟอนต์ด้วย Aspose.CAD
url: /th/java/cad-text-and-annotation/substitute-font-in-dwg/
weight: 11
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# วิธีโหลดไฟล์ DWG ด้วย Java และแทนที่ฟอนต์ด้วย Aspose.CAD

## บทนำ

หากคุณต้องการ **โหลดไฟล์ DWG ด้วย Java** ในแอปพลิเคชันและทำให้ภาพวาดของคุณดูเป็นมืออาชีพ การแทนที่ฟอนต์เป็นวิธีที่ทำได้อย่างรวดเร็ว ด้วย Aspose.CAD for Java คุณสามารถเปลี่ยนสไตล์ข้อความเริ่มต้นเป็นฟอนต์ใดก็ได้ที่ติดตั้งในระบบ เพื่อให้ทุกคำอธิบายแสดงผลตามที่คุณคาดหวัง ในบทแนะนำนี้เราจะเดินผ่านกระบวนการทั้งหมด — ตั้งแต่การโหลดไฟล์ DWG ใน Java ไปจนถึงการใช้เมธอด `setPrimaryFontName` เพื่อเปลี่ยนฟอนต์

## คำตอบสั้น
- **ต้องใช้ไลบรารีอะไร?** Aspose.CAD for Java  
- **สามารถโหลดไฟล์ DWG ด้วย Java ได้หรือไม่?** ได้ เพียงเรียก `Image.load()` กับพาธของ DWG  
- **เมธอดใดที่เปลี่ยนฟอนต์?** `setPrimaryFontName`  
- **ต้องมีลิขสิทธิ์สำหรับการใช้งานจริงหรือไม่?** ต้องมีลิขสิทธิ์เชิงพาณิชย์  
- **สามารถทำการประมวลผลเป็นชุดได้หรือไม่?** แน่นอน — วนลูปผ่านไฟล์หลายไฟล์ด้วยโค้ดเดียวกัน  

## “load dwg file java” คืออะไร?

การโหลดไฟล์ DWG ในสภาพแวดล้อม Java หมายถึงการอ่านข้อมูล CAD แบบไบนารีเข้าสู่วัตถุ `Image` ที่ Aspose.CAD สามารถจัดการได้ เมื่อไฟล์ถูกโหลดแล้ว คุณจะเข้าถึงเลเยอร์, สไตล์, และเอนทิตี้ข้อความได้อย่างเต็มที่ผ่านโปรแกรม

## ทำไมต้องแทนที่ฟอนต์ในไฟล์ DWG?

- **ความสอดคล้อง:** รับประกันว่าผู้ร่วมงานทุกคนจะเห็นแบบอักษรเดียวกัน ไม่ว่าการตั้งค่าฟอนต์ในเครื่องของพวกเขาจะเป็นอย่างไร  
- **ความอ่านง่าย:** ฟอนต์ CAD เริ่มต้นบางตัวอ่านยากบนหน้าจอ การสลับเป็นฟอนต์ที่ชัดเจนเช่น Arial จะช่วยให้เห็นชัดเจนขึ้น  
- **การสร้างแบรนด์:** ทำให้ภาพวาดเทคนิคสอดคล้องกับคู่มือสไตล์ขององค์กร  

## ข้อกำหนดเบื้องต้น

- **Java Development Kit (JDK)** – เวอร์ชันล่าสุด (แนะนำ 8+)  
- **Aspose.CAD for Java** – ดาวน์โหลดจาก [website](https://releases.aspose.com/cad/java/)  
- **ไฟล์ DWG ตัวอย่าง** – ภาพวาดที่คุณต้องการแก้ไข (คุณสามารถใช้ไฟล์ DWG หรือ DXF ใดก็ได้สำหรับการทดสอบ)  

## นำเข้า Namespaces

ในโปรเจกต์ Java ของคุณ ให้นำเข้าคลาสที่จำเป็นสำหรับการทำงานกับ Aspose.CAD การนำเข้าต่าง ๆ นี้ทำให้คุณเข้าถึงการโหลดภาพ, วัตถุ CAD‑specific, และการจัดการสไตล์ได้

```java
import com.aspose.cad.Image;

import com.aspose.cad.fileformats.cad.CadImage;
import com.aspose.cad.fileformats.cad.cadtables.CadStyleTableObject;
```

## คำแนะนำทีละขั้นตอนเพื่อแทนที่ฟอนต์

### ขั้นตอนที่ 1: โหลดไฟล์ DWG ของคุณ (load dwg file java)

แรกสุด ให้ชี้ API ไปที่ตำแหน่งของไฟล์ DWG (หรือ DXF) แล้วโหลดเข้าสู่วัตถุ `CadImage`

```java
// The path to the resource directory.
String dataDir = "Your Document Directory" + "CADConversion/";

String srcFile = dataDir + "conic_pyramid.dxf";
CadImage cadImage = (CadImage) Image.load(srcFile);
```

> **เคล็ดลับ:** หากคุณทำงานกับไฟล์ DWG โดยตรง ให้เปลี่ยนนามสกุล `.dxf` เป็น `.dwg` ในตัวแปร `srcFile`

### ขั้นตอนที่ 2: วนลูปตารางสไตล์และตั้งชื่อฟอนต์หลัก

แต่ละภาพ CAD มีคอลเลกชันของอ็อบเจกต์สไตล์ วนลูปผ่านสไตล์เหล่านั้นและใช้เมธอด `setPrimaryFontName` (เมธอดที่ **ตั้งชื่อฟอนต์หลัก**) เพื่อแทนที่ฟอนต์

```java
for(Object style : cadImage.getStyles())
{
    // Set the font name
    ((com.aspose.cad.fileformats.cad.cadtables.CadStyleTableObject)style).setPrimaryFontName("Arial");
}
```

คุณสามารถเปลี่ยน `"Arial"` เป็นฟอนต์ใดก็ได้ที่ติดตั้งบนเครื่องที่รันโค้ด

### ขั้นตอนที่ 3: บันทึกภาพที่แก้ไขแล้ว

หลังจากอัปเดตฟอนต์แล้ว ให้เขียนการเปลี่ยนแปลงกลับไปยังไฟล์ DWG ใหม่ (หรือเขียนทับไฟล์เดิม)

```java
cadImage.save(dataDir + "output.dwg", new DwgOptions());
```

ไฟล์ที่บันทึกแล้วจะใช้ฟอนต์ที่คุณระบุ และข้อความใด ๆ จะถูกเรนเดอร์ด้วยแบบอักษรนั้น

## ปัญหาที่พบบ่อยและวิธีแก้

| Issue | Solution |
|-------|----------|
| **Font not applied** | ตรวจสอบว่าฟอนต์ติดตั้งบนระบบปฏิบัติการและการสะกดตรงกับที่ระบุ |
| **`Image.load` throws an exception** | ตรวจสอบว่าพาธไฟล์ถูกต้องและไฟล์เป็นรูปแบบ DWG/DXF ที่รองรับ |
| **Performance slowdown on large files** | ประมวลผลไฟล์ในเธรดแยกหรือทำเป็นชุดเพื่อหลีกเลี่ยงการบล็อก UI |

## คำถามที่พบบ่อยเพิ่มเติม

**Q: เมธอด `setPrimaryFontName` มีผลต่อเอนทิตี้ข้อความเท่านั้นหรือไม่?**  
A: เมธอดนี้อัปเดตฟอนต์หลักของตารางสไตล์ ซึ่งจะส่งผลต่อข้อความทั้งหมดที่อ้างอิงสไตล์นั้น

**Q: สามารถใช้ฟอนต์กำหนดเองที่ไม่ได้ติดตั้งบนระบบได้หรือไม่?**  
A: Aspose.CAD พึ่งพารีจิสทรีฟอนต์ของระบบปฏิบัติการ หากต้องการใช้ฟอนต์กำหนดเอง ต้องติดตั้งฟอนต์นั้นบนเครื่องที่รันโค้ด

**Q: สามารถเปลี่ยนฟอนต์ให้กับเลเยอร์เดียวได้หรือไม่?**  
A: ได้ คุณสามารถกรองสไตล์ตามชื่อเลเยอร์ก่อนเรียก `setPrimaryFontName`

**Q: ต้องใช้เวอร์ชัน Aspose.CAD ใดสำหรับไฟล์ DWG 2022?**  
A: รุ่นล่าสุด (ณ ปี 2025) รองรับ DWG 2022 อย่างเต็มที่ ตรวจสอบ release notes สำหรับการสนับสนุนรูปแบบเฉพาะ

**Q: จะจัดการเรื่องลิขสิทธิ์ในสภาพแวดล้อมการพัฒนาอย่างไร?**  
A: ใช้ลิขสิทธิ์ประเมินผลชั่วคราวสำหรับการทดสอบ สำหรับการผลิต ให้ฝังไฟล์ลิขสิทธิ์ที่ซื้อไว้ด้วย `License.setLicense("Aspose.Total.Java.lic");`

---

**Last Updated:** 2025-12-28  
**Tested With:** Aspose.CAD for Java 24.11  
**Author:** Aspose  

{{< /blocks/products/pf/tutorial-page-section >}}

{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}

{{< blocks/products/products-backtop-button >}}